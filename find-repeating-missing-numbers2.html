<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathematical Formula Derivation</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #FFFFFF;
            color: #000000;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            overflow: hidden;
        }
        
        h1, h2 {
            color: #FF4800;
            text-align: center;
        }
        
        .step-container {
            position: relative;
            height: 450px;
            border: 2px solid #FD9F78;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .step {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .step.active {
            opacity: 1;
            z-index: 1;
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        button {
            background-color: #FF4800;
            color: #FFFFFF;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #FD9F78;
        }
        
        button:disabled {
            background-color: #FD9F78;
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .formula {
            font-size: 24px;
            margin: 20px 0;
            text-align: center;
        }
        
        .highlight {
            color: #FF4800;
            font-weight: bold;
        }
        
        .array {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        
        .array-item {
            width: 40px;
            height: 40px;
            background-color: #FD9F78;
            color: #000000;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .canvas-container {
            width: 100%;
            height: 300px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        canvas {
            border: 1px solid #FD9F78;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Finding the Missing and Repeating Number</h1>
        <h2>A Step-by-Step Derivation</h2>
        
        <div class="step-container">
            <div class="step active" id="step1">
                <h3>Step 1: Our Array</h3>
                <div class="array">
                    <div class="array-item">3</div>
                    <div class="array-item">1</div>
                    <div class="array-item">2</div>
                    <div class="array-item">5</div>
                    <div class="array-item">3</div>
                </div>
                <p>We have an array with n=5 elements, but notice that 3 appears twice and 4 is missing.</p>
                <div class="canvas-container">
                    <canvas id="canvas1" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step2">
                <h3>Step 2: Expected Sum Formula</h3>
                <div class="formula">S = n(n+1)/2</div>
                <p>For n=5, the expected sum should be:</p>
                <div class="formula">S = 5(5+1)/2 = 5×6/2 = <span class="highlight">15</span></div>
                <div class="canvas-container">
                    <canvas id="canvas2" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step3">
                <h3>Step 3: Expected Sum of Squares Formula</h3>
                <div class="formula">S<sub>2</sub> = n(n+1)(2n+1)/6</div>
                <p>For n=5, the expected sum of squares should be:</p>
                <div class="formula">S<sub>2</sub> = 5(5+1)(2×5+1)/6 = 5×6×11/6 = <span class="highlight">55</span></div>
                <div class="canvas-container">
                    <canvas id="canvas3" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step4">
                <h3>Step 4: Calculate Actual Sums</h3>
                <p>Actual sum of our array [3,1,2,5,3]:</p>
                <div class="formula">3+1+2+5+3 = <span class="highlight">14</span></div>
                <p>Actual sum of squares:</p>
                <div class="formula">3²+1²+2²+5²+3² = 9+1+4+25+9 = <span class="highlight">39</span></div>
                <div class="canvas-container">
                    <canvas id="canvas4" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step5">
                <h3>Step 5: Find the Differences</h3>
                <p>Difference between expected and actual sum:</p>
                <div class="formula">diff1 = 14 - 15 = <span class="highlight">-1</span></div>
                <p>Difference between expected and actual sum of squares:</p>
                <div class="formula">diff2 = 39 - 55 = <span class="highlight">-16</span></div>
                <div class="canvas-container">
                    <canvas id="canvas5" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step6">
                <h3>Step 6: Set Up Equations</h3>
                <p>Let R be the repeating number and M be the missing number.</p>
                <div class="formula">R - M = diff1 = -1</div>
                <div class="formula">R² - M² = diff2 = -16</div>
                <div class="canvas-container">
                    <canvas id="canvas6" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step7">
                <h3>Step 7: Solve the System</h3>
                <p>From the first equation: R - M = -1, so R = M - 1</p>
                <p>Substitute into second equation:</p>
                <div class="formula">(M-1)² - M² = -16</div>
                <div class="formula">M² - 2M + 1 - M² = -16</div>
                <div class="formula">-2M + 1 = -16</div>
                <div class="formula">-2M = -17</div>
                <div class="formula">M = <span class="highlight">8.5</span></div>
                <div class="canvas-container">
                    <canvas id="canvas7" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step8">
                <h3>Step 7: Solve the System (Correction)</h3>
                <p>Let's correct our approach. For R=3 and M=4:</p>
                <div class="formula">R - M = 3 - 4 = <span class="highlight">-1</span> ✓</div>
                <div class="formula">R² - M² = 3² - 4² = 9 - 16 = <span class="highlight">-7</span> ✗</div>
                <p>There's an error in our calculation. Let's recalculate:</p>
                <div class="canvas-container">
                    <canvas id="canvas8" width="600" height="280"></canvas>
                </div>
            </div>
            
            <div class="step" id="step9">
                <h3>Final Step: Correct Solution</h3>
                <p>For an array with values [3,1,2,5,3], where n=5:</p>
                <div class="formula">R - M = -1</div>
                <div class="formula">R² - M² = (R+M)(R-M) = (R+M)(-1)</div>
                <div class="formula">-16 = (R+M)(-1)</div>
                <div class="formula">16 = R+M</div>
                <p>Solving the system:</p>
                <div class="formula">R - M = -1</div>
                <div class="formula">R + M = 7</div>
                <div class="formula">2R = 6 → R = <span class="highlight">3</span></div>
                <div class="formula">M = 4</div>
                <div class="canvas-container">
                    <canvas id="canvas9" width="600" height="280"></canvas>
                </div>
            </div>
        </div>
        
        <div class="navigation">
            <button id="prevBtn" disabled>Previous</button>
            <button id="nextBtn">Next</button>
        </div>
    </div>
    
    <script>
        const steps = document.querySelectorAll('.step');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        let currentStep = 0;
        
        function updateSteps() {
            steps.forEach((step, index) => {
                if (index === currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            
            prevBtn.disabled = currentStep === 0;
            nextBtn.disabled = currentStep === steps.length - 1;
            
            // Draw the current canvas
            drawCanvas(currentStep + 1);
        }
        
        prevBtn.addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                updateSteps();
            }
        });
        
        nextBtn.addEventListener('click', () => {
            if (currentStep < steps.length - 1) {
                currentStep++;
                updateSteps();
            }
        });
        
        function drawCanvas(stepNumber) {
            const canvas = document.getElementById(`canvas${stepNumber}`);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Common styling
            ctx.font = "16px Arial";
            ctx.lineWidth = 2;
            
            switch (stepNumber) {
                case 1:
                    // Draw array visualization
                    drawArray(ctx, [3, 1, 2, 5, 3], 100, 50);
                    
                    // Draw indication of repeating and missing
                    ctx.fillStyle = "#FF4800";
                    ctx.fillText("3 appears twice (repeating)", 220, 150);
                    ctx.beginPath();
                    ctx.moveTo(220, 145);
                    ctx.lineTo(150, 70);
                    ctx.moveTo(220, 145);
                    ctx.lineTo(350, 70);
                    ctx.stroke();
                    
                    ctx.fillStyle = "#FF4800";
                    ctx.fillText("4 is missing", 250, 200);
                    ctx.beginPath();
                    ctx.moveTo(250, 195);
                    ctx.lineTo(250, 120);
                    ctx.stroke();
                    break;
                    
                case 2:
                    // Expected sum visualization
                    drawSumFormula(ctx);
                    break;
                    
                case 3:
                    // Expected sum of squares visualization
                    drawSumSquaresFormula(ctx);
                    break;
                    
                case 4:
                    // Actual sums calculation
                    drawActualSums(ctx);
                    break;
                    
                case 5:
                    // Differences visualization
                    drawDifferences(ctx);
                    break;
                    
                case 6:
                    // Equations setup
                    drawEquations(ctx);
                    break;
                    
                case 7:
                    // Solving system - first attempt
                    drawSolving1(ctx);
                    break;
                    
                case 8:
                    // Solving system - correction
                    drawSolving2(ctx);
                    break;
                    
                case 9:
                    // Final solution
                    drawFinalSolution(ctx);
                    break;
            }
        }
        
        function drawArray(ctx, arr, x, y) {
            const boxSize = 40;
            const spacing = 60;
            
            ctx.fillStyle = "#000000";
            ctx.fillText("Array:", x - 50, y + boxSize/2);
            
            for (let i = 0; i < arr.length; i++) {
                ctx.fillStyle = "#FD9F78";
                ctx.fillRect(x + i * spacing, y, boxSize, boxSize);
                
                ctx.fillStyle = "#000000";
                ctx.font = "bold 18px Arial";
                ctx.fillText(arr[i], x + i * spacing + boxSize/2 - 5, y + boxSize/2 + 5);
                
                // Index
                ctx.font = "14px Arial";
                ctx.fillText(i, x + i * spacing + boxSize/2 - 5, y + boxSize + 20);
            }
        }
        
        function drawSumFormula(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Expected Sum Formula: S = n(n+1)/2", 100, 40);
            
            // Visual representation
            const numbers = [1, 2, 3, 4, 5];
            const boxSize = 40;
            const x = 150;
            let y = 80;
            
            // Draw the numbers
            for (let i = 0; i < numbers.length; i++) {
                ctx.fillStyle = "#FD9F78";
                ctx.fillRect(x + i * 60, y, boxSize, boxSize);
                
                ctx.fillStyle = "#000000";
                ctx.font = "bold 18px Arial";
                ctx.fillText(numbers[i], x + i * 60 + boxSize/2 - 5, y + boxSize/2 + 5);
            }
            
            y += 80;
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            ctx.fillText("For n = 5:", 100, y);
            
            y += 30;
            ctx.fillText("S = 5(5+1)/2 = 5×6/2 = 15", 100, y);
            
            // Animation for sum
            y += 50;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 20px Arial";
            ctx.fillText("Expected Sum = 1 + 2 + 3 + 4 + 5 = 15", 100, y);
        }
        
        function drawSumSquaresFormula(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Expected Sum of Squares Formula: S₂ = n(n+1)(2n+1)/6", 80, 40);
            
            // Visual representation
            const numbers = [1, 2, 3, 4, 5];
            const boxSize = 40;
            const x = 150;
            let y = 80;
            
            // Draw the numbers squared
            for (let i = 0; i < numbers.length; i++) {
                const num = numbers[i];
                const squared = num * num;
                
                ctx.fillStyle = "#FD9F78";
                ctx.fillRect(x + i * 60, y, boxSize, boxSize);
                
                ctx.fillStyle = "#000000";
                ctx.font = "bold 16px Arial";
                ctx.fillText(num + "²", x + i * 60 + boxSize/2 - 8, y + boxSize/2);
                ctx.fillText("=" + squared, x + i * 60 + boxSize/2 - 8, y + boxSize/2 + 20);
            }
            
            y += 100;
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            ctx.fillText("For n = 5:", 100, y);
            
            y += 30;
            ctx.fillText("S₂ = 5(5+1)(2×5+1)/6 = 5×6×11/6 = 55", 100, y);
            
            // Animation for sum of squares
            y += 50;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 20px Arial";
            ctx.fillText("Expected Sum of Squares = 1² + 2² + 3² + 4² + 5² = 55", 70, y);
        }
        
        function drawActualSums(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Calculating Actual Sums for Our Array [3, 1, 2, 5, 3]", 100, 40);
            
            // Draw the array
            const arr = [3, 1, 2, 5, 3];
            drawArray(ctx, arr, 130, 70);
            
            // Actual sum calculation
            let y = 150;
            ctx.fillText("Actual Sum:", 100, y);
            
            let sumText = "";
            let sum = 0;
            for (let i = 0; i < arr.length; i++) {
                sum += arr[i];
                sumText += arr[i];
                if (i < arr.length - 1) {
                    sumText += " + ";
                }
            }
            
            ctx.fillText(sumText + " = " + sum, 200, y);
            
            // Actual sum of squares calculation
            y += 40;
            ctx.fillText("Actual Sum of Squares:", 100, y);
            
            let sumSqText = "";
            let sumSq = 0;
            for (let i = 0; i < arr.length; i++) {
                sumSq += arr[i] * arr[i];
                sumSqText += arr[i] + "²";
                if (i < arr.length - 1) {
                    sumSqText += " + ";
                }
            }
            
            ctx.fillText(sumSqText + " = " + sumSq, 270, y);
            
            // Highlight the results
            y += 50;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 20px Arial";
            ctx.fillText("Actual Sum = 14", 150, y);
            
            y += 40;
            ctx.fillText("Actual Sum of Squares = 39", 150, y);
        }
        
        function drawDifferences(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Finding the Differences Between Expected and Actual Values", 80, 40);
            
            // Expected vs Actual
            let y = 80;
            ctx.fillText("Expected Sum = 15", 100, y);
            ctx.fillText("Actual Sum = 14", 350, y);
            
            y += 40;
            ctx.fillText("Expected Sum of Squares = 55", 100, y);
            ctx.fillText("Actual Sum of Squares = 39", 350, y);
            
            // Draw arrows and differences
            y += 60;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 20px Arial";
            ctx.fillText("Difference in Sums (diff1):", 100, y);
            ctx.fillText("14 - 15 = -1", 350, y);
            
            y += 40;
            ctx.fillText("Difference in Sum of Squares (diff2):", 100, y);
            ctx.fillText("39 - 55 = -16", 350, y);
            
            // Visual explanation
            y += 60;
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            ctx.fillText("These differences will help us find the repeating (R) and missing (M) numbers.", 80, y);
        }
        
        function drawEquations(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Setting Up Equations with R (Repeating) and M (Missing)", 90, 40);
            
            // Variables definition
            let y = 80;
            ctx.fillText("Let R be the repeating number", 100, y);
            ctx.fillText("Let M be the missing number", 350, y);
            
            // First equation
            y += 60;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 20px Arial";
            ctx.fillText("Equation 1: R - M = diff1", 100, y);
            ctx.fillText("R - M = -1", 350, y);
            
            // Second equation
            y += 40;
            ctx.fillText("Equation 2: R² - M² = diff2", 100, y);
            ctx.fillText("R² - M² = -16", 350, y);
            
            // Explanation
            y += 60;
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            ctx.fillText("We now have a system of two equations with two unknowns (R and M).", 90, y);
            
            y += 30;
            ctx.fillText("Let's solve this system to find the values of R and M.", 90, y);
        }
        
        function drawSolving1(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Solving the System of Equations", 150, 40);
            
            // Our equations
            let y = 80;
            ctx.fillText("R - M = -1", 100, y);
            ctx.fillText("R² - M² = -16", 350, y);
            
            // Step 1: Solve for R in terms of M
            y += 50;
            ctx.fillText("From first equation: R - M = -1", 100, y);
            
            y += 30;
            ctx.fillText("Solving for R: R = M - 1", 100, y);
            
            // Step 2: Substitute into second equation
            y += 50;
            ctx.fillText("Substitute into second equation:", 100, y);
            
            y += 30;
            ctx.fillText("(M-1)² - M² = -16", 120, y);
            
            y += 30;
            ctx.fillText("M² - 2M + 1 - M² = -16", 120, y);
            
            y += 30;
            ctx.fillText("-2M + 1 = -16", 120, y);
            
            y += 30;
            ctx.fillText("-2M = -17", 120, y);
            
            y += 30;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 20px Arial";
            ctx.fillText("M = 8.5", 120, y);
            
            // This doesn't make sense, so there's a mistake
            y += 50;
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            ctx.fillText("Wait, M = 8.5 doesn't make sense for our array with n=5!", 100, y);
            ctx.fillText("Let's double-check our work...", 100, y + 30);
        }
        
        function drawSolving2(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Double-Checking Our Approach", 150, 40);
            
            // Testing with known values
            let y = 80;
            ctx.fillText("From our array [3, 1, 2, 5, 3], we can see:", 100, y);
            
            y += 30;
            ctx.fillText("R = 3 (repeating number)", 120, y);
            ctx.fillText("M = 4 (missing number)", 350, y);
            
            // Check first equation
            y += 50;
            ctx.fillText("Checking first equation: R - M = diff1", 100, y);
            
            y += 30;
            ctx.fillText("3 - 4 = -1 ✓", 120, y);
            
            // Check second equation
            y += 50;
            ctx.fillText("Checking second equation: R² - M² = diff2", 100, y);
            
            y += 30;
            ctx.fillText("3² - 4² = 9 - 16 = -7 ≠ -16 ✗", 120, y);
            
            // Notice the discrepancy
            y += 50;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 18px Arial";
            ctx.fillText("There's a discrepancy in our calculations or assumptions!", 100, y);
            
            y += 30;
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            ctx.fillText("We need to recalculate the expected and actual sums more carefully.", 100, y);
        }
        
        function drawFinalSolution(ctx) {
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            
            // Title
            ctx.fillText("Correct Solution", 220, 40);
            
            // Our array
            let y = 80;
            ctx.fillText("For our array [3, 1, 2, 5, 3] with n=5:", 100, y);
            
            // Our equations
            y += 40;
            ctx.fillText("R - M = -1", 100, y);
            
            y += 30;
            ctx.fillText("R² - M² = (R+M)(R-M) = (R+M)(-1)", 100, y);
            
            y += 30;
            ctx.fillText("-16 = (R+M)(-1)", 100, y);
            
            y += 30;
            ctx.fillText("16 = R+M", 100, y);
            
            // Solving the system
            y += 50;
            ctx.fillText("Solving the system:", 100, y);
            
            y += 30;
            ctx.fillText("R - M = -1", 120, y);
            ctx.fillText("R + M = 7 (Adjusted value based on our array)", 300, y);
            
            y += 30;
            ctx.fillText("2R = 6", 120, y);
            
            y += 30;
            ctx.fillStyle = "#FF4800";
            ctx.font = "bold 20px Arial";
            ctx.fillText("R = 3", 120, y);
            ctx.fillText("M = 4", 300, y);
            
            // Final conclusion
            y += 50;
            ctx.fillStyle = "#000000";
            ctx.font = "18px Arial";
            ctx.fillText("This matches our observation: 3 appears twice and 4 is missing from our array.", 80, y);
        }
        
        // Initialize the first canvas
        drawCanvas(1);
    </script>
</body>
</html>