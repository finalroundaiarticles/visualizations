<!DOCTYPE html>
<html>
<head>
    <title>Array Representation of Binary Heap</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #FFFFFF;
            margin: 0;
            padding: 20px;
            color: #000000;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }
        h1 {
            color: #FF4800;
            margin-bottom: 30px;
        }
        .animation-container {
            position: relative;
            height: 500px;
            margin: 20px 0;
        }
        .heap-node {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #FD9F78;
            border: 2px solid #FF4800;
            color: #000000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: absolute;
            transition: all 0.5s ease;
        }
        .array-container {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        .array-element {
            width: 50px;
            height: 50px;
            border: 2px solid #FF4800;
            margin: 0 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            background-color: #FD9F78;
            position: relative;
        }
        .array-index {
            position: absolute;
            bottom: -25px;
            font-size: 14px;
            color: #000000;
        }
        .arrows-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .explanation {
            margin: 30px 0;
            padding: 15px;
            border: 1px solid #FD9F78;
            text-align: left;
            border-radius: 5px;
        }
        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            background-color: #FF4800;
            color: #FFFFFF;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #FD9F78;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .connection-line {
            position: absolute;
            background-color: #FF4800;
            transform-origin: 0 0;
            pointer-events: none;
            z-index: -1;
        }
        .highlight {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Array Representation of Binary Heap</h1>
        
        <div class="animation-container" id="animationContainer">
            <div class="arrows-container" id="arrowsContainer"></div>
            <!-- Nodes will be added dynamically -->
        </div>
        
        <div class="array-container" id="arrayContainer">
            <!-- Array elements will be added dynamically -->
        </div>
        
        <div class="explanation" id="explanation">
            Welcome to the Binary Heap visualization! Use the navigation buttons to learn how a binary heap is represented as an array.
        </div>
        
        <div class="buttons">
            <button id="prevBtn" disabled>Previous</button>
            <button id="nextBtn">Next</button>
        </div>
    </div>
    
    <script>
        // Initial heap array
        const heapArray = [10, 9, 8, 4, 5, 7];
        
        // Node positions for the binary tree visualization
        const nodePositions = [
            { x: 450, y: 50 },  // Root (index 0)
            { x: 250, y: 150 }, // Left child of root (index 1)
            { x: 650, y: 150 }, // Right child of root (index 2)
            { x: 150, y: 250 }, // Left child of index 1 (index 3)
            { x: 350, y: 250 }, // Right child of index 1 (index 4)
            { x: 550, y: 250 }, // Left child of index 2 (index 5)
        ];
        
        // Get DOM elements
        const animationContainer = document.getElementById('animationContainer');
        const arrayContainer = document.getElementById('arrayContainer');
        const arrowsContainer = document.getElementById('arrowsContainer');
        const explanation = document.getElementById('explanation');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        
        // State management
        let currentStep = 0;
        const totalSteps = 7; // Total number of steps in the animation
        
        // Create array representation
        function createArrayElements() {
            arrayContainer.innerHTML = '';
            heapArray.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                element.id = `array-${index}`;
                element.innerHTML = value;
                
                const indexSpan = document.createElement('span');
                indexSpan.className = 'array-index';
                indexSpan.textContent = index;
                
                element.appendChild(indexSpan);
                arrayContainer.appendChild(element);
            });
        }
        
        // Create tree nodes
        function createTreeNodes() {
            animationContainer.innerHTML = '<div class="arrows-container" id="arrowsContainer"></div>';
            arrowsContainer = document.getElementById('arrowsContainer');
            
            heapArray.forEach((value, index) => {
                if (index < nodePositions.length) {
                    const node = document.createElement('div');
                    node.className = 'heap-node';
                    node.id = `node-${index}`;
                    node.textContent = value;
                    node.style.left = `${nodePositions[index].x}px`;
                    node.style.top = `${nodePositions[index].y}px`;
                    animationContainer.appendChild(node);
                }
            });
        }
        
        // Draw a line between two nodes
        function drawLine(fromNode, toNode, color = '#FF4800', thickness = 2) {
            const fromRect = fromNode.getBoundingClientRect();
            const toRect = toNode.getBoundingClientRect();
            
            const fromX = fromRect.left + fromRect.width / 2;
            const fromY = fromRect.top + fromRect.height / 2;
            const toX = toRect.left + toRect.width / 2;
            const toY = toRect.top + toRect.height / 2;
            
            const animContainerRect = animationContainer.getBoundingClientRect();
            
            const lineLength = Math.sqrt(Math.pow(toX - fromX, 2) + Math.pow(toY - fromY, 2));
            const angle = Math.atan2(toY - fromY, toX - fromX) * 180 / Math.PI;
            
            const line = document.createElement('div');
            line.className = 'connection-line';
            line.style.width = `${lineLength}px`;
            line.style.height = `${thickness}px`;
            line.style.backgroundColor = color;
            line.style.position = 'absolute';
            line.style.left = `${fromX - animContainerRect.left}px`;
            line.style.top = `${fromY - animContainerRect.top}px`;
            line.style.transform = `rotate(${angle}deg)`;
            
            arrowsContainer.appendChild(line);
        }
        
        // Connect parent nodes to their children
        function connectNodes() {
            arrowsContainer.innerHTML = '';
            
            // For each parent node
            for (let i = 0; i < 3; i++) {
                const parentNode = document.getElementById(`node-${i}`);
                
                // Left child
                const leftChildIndex = 2 * i + 1;
                if (leftChildIndex < heapArray.length) {
                    const leftChild = document.getElementById(`node-${leftChildIndex}`);
                    if (parentNode && leftChild) {
                        drawLine(parentNode, leftChild);
                    }
                }
                
                // Right child
                const rightChildIndex = 2 * i + 2;
                if (rightChildIndex < heapArray.length) {
                    const rightChild = document.getElementById(`node-${rightChildIndex}`);
                    if (parentNode && rightChild) {
                        drawLine(parentNode, rightChild);
                    }
                }
            }
        }
        
        // Remove all highlights
        function removeHighlights() {
            document.querySelectorAll('.heap-node, .array-element').forEach(el => {
                el.classList.remove('highlight');
            });
        }
        
        // Initialize the visualization
        function initVisualization() {
            createArrayElements();
            createTreeNodes();
            connectNodes();
            updateStep(0);
        }
        
        // Update the animation step
        function updateStep(step) {
            removeHighlights();
            currentStep = step;
            
            prevBtn.disabled = currentStep === 0;
            nextBtn.disabled = currentStep === totalSteps - 1;
            
            switch (step) {
                case 0:
                    explanation.innerHTML = "<p>Welcome to the Binary Heap visualization! A binary heap is a complete binary tree that satisfies the heap property. Here we're looking at a max heap where each parent node is greater than or equal to its children.</p><p>This visualization shows how a binary heap tree is represented as an array.</p>";
                    break;
                    
                case 1:
                    explanation.innerHTML = "<p>Let's start with the root node (10). In an array representation, the root is always stored at index 0.</p>";
                    document.getElementById('node-0').classList.add('highlight');
                    document.getElementById('array-0').classList.add('highlight');
                    break;
                    
                case 2:
                    explanation.innerHTML = "<p>For any node at index i, its left child is at index 2*i+1.</p><p>The left child of the root (index 0) is at 2*0+1 = 1, which is the value 9.</p>";
                    document.getElementById('node-0').classList.add('highlight');
                    document.getElementById('node-1').classList.add('highlight');
                    document.getElementById('array-1').classList.add('highlight');
                    break;
                    
                case 3:
                    explanation.innerHTML = "<p>For any node at index i, its right child is at index 2*i+2.</p><p>The right child of the root (index 0) is at 2*0+2 = 2, which is the value 8.</p>";
                    document.getElementById('node-0').classList.add('highlight');
                    document.getElementById('node-2').classList.add('highlight');
                    document.getElementById('array-2').classList.add('highlight');
                    break;
                    
                case 4:
                    explanation.innerHTML = "<p>Similarly, the left child of node at index 1 (value 9) is at 2*1+1 = 3, which is the value 4.</p>";
                    document.getElementById('node-1').classList.add('highlight');
                    document.getElementById('node-3').classList.add('highlight');
                    document.getElementById('array-3').classList.add('highlight');
                    break;
                    
                case 5:
                    explanation.innerHTML = "<p>The right child of node at index 1 (value 9) is at 2*1+2 = 4, which is the value 5.</p>";
                    document.getElementById('node-1').classList.add('highlight');
                    document.getElementById('node-4').classList.add('highlight');
                    document.getElementById('array-4').classList.add('highlight');
                    break;
                    
                case 6:
                    explanation.innerHTML = "<p>The left child of node at index 2 (value 8) is at 2*2+1 = 5, which is the value 7.</p><p>We can also work backward: for any node at index i, its parent is at index (i-1)/2 (integer division).</p>";
                    document.getElementById('node-2').classList.add('highlight');
                    document.getElementById('node-5').classList.add('highlight');
                    document.getElementById('array-5').classList.add('highlight');
                    break;
            }
        }
        
        // Event handlers for navigation buttons
        prevBtn.addEventListener('click', () => {
            if (currentStep > 0) {
                updateStep(currentStep - 1);
            }
        });
        
        nextBtn.addEventListener('click', () => {
            if (currentStep < totalSteps - 1) {
                updateStep(currentStep + 1);
            }
        });
        
        // Initialize the visualization when the page loads
        window.onload = initVisualization;
    </script>
</body>
</html>